(()=>{"use strict";var t={502:(t,e,s)=>{e.y=void 0;const i=s(344);e.y=class{constructor(t,e){this.state={cities:[{city:""}]},this.events={defaultEvent:()=>null},this.el=t,e?this.setState(e):this.onMount(t)}setState(t){this.state=t,this.render()}subscribeToEvents(){Object.keys(this.events).forEach((t=>{const[e,s]=t.split("@");document.querySelector(`.${s}`).addEventListener(e,this.events[t],!0)}))}onMount(t){this.el.innerHTML=this.el.innerHTML}render(){const t=i.template("{{for data as cities}}\n<li> {{city}}</li>\n",this.state);return this.el.innerHTML=t,t}}},36:(t,e,s)=>{e.G=void 0;const i=s(344),n={weather:"",base:"",temp:0,tempFeelsLike:0,pressure:0,humidity:0,visibility:0,windSpeed:0,name:""};e.G=class{constructor(t,e){this.events={defaultEvent:()=>null},this.state=n,this.el=t,e?this.setState(e):this.onMount(t)}subscribeToEvents(){Object.keys(this.events).forEach((t=>{const[e,s]=t.split("@");document.querySelector(`.${s}`).addEventListener(e,this.events[t])}))}setState(t){Object.keys(t).forEach((e=>{this.state[e]=t[e]})),this.render()}onMount(t){this.render()}render(){const t=i.template("In {{name}} now is\n{{weather}},\nTemperature: {{temp}} C,\nTemperature is feels like: {{tempFeelsLike}} C,\nHumidity:{{humidity}}%,\nAtmospheric pressure: {{pressure}} Pa,\nWind speed: {{windSpeed}} m/s",this.state);return this.el.innerHTML=t,t}}},747:(t,e)=>{e.k=void 0,e.k=function(t){return{name:t.name,weather:t.weather[0].main,temp:t.main.temp,tempFeelsLike:t.main.feels_like,humidity:t.main.humidity,pressure:t.main.pressure,windSpeed:t.wind.speed}}},344:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.template=void 0,e.template=function t(e,s){return e.replace(/{{if (\w+)}}\n?([a-zA-Z0-9{}<>"#!.,/= ]{1,})\n?{{endif}}/gm,((t,e,i)=>s[e]?i:"")).replace(/{{for \w+ as (\w+)}}\n?([a-zA-Z0-9{}()<>"#!.,/= ]{1,})\n?(_{{isFirst ([a-zA-Z0-9{}()<>"#!.,/= ]{1,})}})?\n?(_{{isLast ([a-zA-Z0-9{}()<>"#!.,/= ]{1,})}})?/g,((e,i,n,...r)=>{let a,o,c="";return/isFirst/.test(r[0])?(a=r[1],o=r[3]):(/isLast/.test(r[0])||r[3])&&(o=r[3]),s[i].forEach(((r,l)=>{let u;u=0===l&&void 0!==a?/{{index}}/g.test(a)?a.replace(/{{index}}/g,`${1+l}`):a:l===s[i].length-1&&void 0!==o?/{{index}}/g.test(o)?o.replace(/{{index}}/g,`${1+l}`):o:/{{index}}/g.test(n)?n.replace(/{{index}}/g,`${1+l}`):n,c+=/\n/g.test(e)?`${t(u,r)}\n`:t(u,r)})),c})).replace(/{{(\w+)}}/g,((t,e)=>s[e]?s[e]:""))}}},e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={exports:{}};return t[i](n,n.exports,s),n.exports}(()=>{function t(t,e){const s=e.coord.lat,i=`https://static-maps.yandex.ru/1.x/?ll=${e.coord.lon},${s}&size=400,400&z=12&l=map&pt=37.620070,55.753630,pmwtm1~37.64,55.76363,pmwtm99`;t.src=i}async function e(t){try{const e=`https://api.openweathermap.org/data/2.5/weather?q=${t}&appid=29322a2e1ecf125b380cfcee03239f35&units=metric`,s=await fetch(e);return await s.json()}catch(t){return console.log("Can not downoload weather data!")}}async function i(s){const i=s.target.innerText,n=await e(i),r=`\n    In ${(a=n).name} now is \n    ${a.weather[0].main},\n    Temperature: ${a.main.temp} C,\n    Temperature is feels like: ${a.main.feels_like} C,\n    Humidity:${a.main.humidity}%,\n    Atmospheric pressure: ${a.main.pressure} Pa,\n    Wind speed: ${a.wind.speed} m/s`;var a;const o=document.querySelector(".weatherInReqCity"),c=document.querySelector(".cityMap");!function(t,e){t.innerText=e}(o,r),t(c,n)}var n=s(747);function r(t){const e=JSON.parse(localStorage.getItem("historyList"));e.cities.push({city:t}),localStorage.setItem("historyList",JSON.stringify(e))}function a(t,e,s,...i){0===i.length?t.addEventListener(e,s,!0):t.addEventListener(e,s.bind(null,...i))}var o=s(36),c=s(502);0===localStorage.length&&localStorage.setItem("historyList",JSON.stringify({cities:[{city:""}]}));const l=new o.G(document.querySelector(".userCityBlock").getElementsByTagName("p").item(1)),u=new o.G(document.querySelector(".weatherInReqCity")),d=new c.y(document.querySelector(".historyList")),h=document.querySelector(".textbox"),m=document.querySelector(".cityMap");a(document.querySelector("button"),"click",(async function(s,i,a,o){const c=s.value;if(""===c)return console.log("Empty city requare!");const l=await e(c),u=(0,n.k)(l);return i.setState(u),function(t,e){for(let s=0;s<t.state.cities.length;s+=1)if(t.state.cities[s].city===e)return console.log("exit"),null;if(""===t.state.cities[0].city){const s=t.state;s.cities[0].city=e,t.setState(s),localStorage.clear(),localStorage.setItem("historyList",JSON.stringify({cities:[{city:e}]}))}else if(t.state.cities.length<10){const s=t.state;s.cities.push({city:e}),t.setState(s),r(e)}else{const s=t.state;s.cities.shift(),s.cities.push({city:e}),t.setState(s),function(){const t=JSON.parse(localStorage.getItem("historyList"));t.cities.shift(),localStorage.setItem("historyList",JSON.stringify(t))}(),r(e)}}(a,c),t(o,l),null}),h,u,d,m);const y=0===localStorage.length?null:JSON.parse(localStorage.getItem("historyList"));""!==y.cities[0].city&&d.setState(y),d.events={"click@historyList":i},d.subscribeToEvents(),a(document.querySelector(".historyList"),"click",i),async function(){const s=await async function(){try{const t="https://get.geojs.io/v1/ip/geo.json",e=await fetch(t);return(await e.json()).city}catch(t){return console.log("Can not downoload data about your city!")}}(),i=await e(s),r=(0,n.k)(i);l.setState(r),t(document.querySelector(".cityMap"),i)}()})()})();