(()=>{"use strict";function t(t){return`\n    In ${t.name} now is \n    ${t.weather[0].main},\n    Temperature: ${t.main.temp} C,\n    Temperature is feels like: ${t.main.feels_like} C,\n    Humidity:${t.main.humidity}%,\n    Atmospheric pressure: ${t.main.pressure} Pa,\n    Wind speed: ${t.wind.speed} m/s`}function e(t,e){t.innerText=e}function n(t,e){const n=`http://maps.googleapis.com/maps/api/staticmap?center=${e.coord.lat},${e.coord.lon}&zoom=10&size=400x400&key=AIzaSyAu9cQhEoU0Uj0-GkEBnWGP_4WpRdos6LU`;t.src=n}async function o(t){try{const e=`https://api.openweathermap.org/data/2.5/weather?q=${t}&appid=29322a2e1ecf125b380cfcee03239f35&units=metric`,n=await fetch(e);return await n.json()}catch(t){return console.log("Can not downoload weather data!")}}function r(t,e,n,...o){0===o.length?t.addEventListener(e,n,!0):t.addEventListener(e,n.bind(null,...o))}localStorage.length>0&&!localStorage.getItem("historyList").includes("[")&&localStorage.clear(),0===localStorage.length&&localStorage.setItem("historyList",JSON.stringify([]));const a=document.querySelector(".textbox"),i=document.querySelector(".weatherInReqCity"),c=document.querySelector(".historyList"),s=document.querySelector(".cityMap");r(document.querySelector("button"),"click",(async function(r,a,i,c){const s=r.value;if(""===s)return!1;const l=await o(s);return e(a,t(l)),function(t,e){const n=e.getElementsByTagName("li");if(Array.from(n).filter((e=>e.innerText===t)).length>0)return null;n.length>9&&(e.removeChild(n.item(0)),function(){const t=JSON.parse(localStorage.getItem("historyList"));t.shift(),localStorage.setItem("historyList",JSON.stringify(t))}());const o=document.createElement("li");o.innerText=t,e.append(o),function(t){const e=JSON.parse(localStorage.getItem("historyList"));e.push(t),localStorage.setItem("historyList",JSON.stringify(e))}(t)}(s,i),n(c,l),null}),a,i,c,s);const l=0===localStorage.length?null:JSON.parse(localStorage.getItem("historyList"));0!==l.lenght&&l.map((t=>{const e=document.createElement("li");return e.innerText=t,c.append(e),t})),r(document.querySelector(".historyList"),"click",(async function(r){const a=r.target.innerText,i=await o(a),c=t(i),s=document.querySelector(".requaredCity").getElementsByTagName("p").item(0),l=document.querySelector(".cityMap");e(s,c),n(l,i)})),async function(){const r=await async function(){try{const t="https://get.geojs.io/v1/ip/geo.json",e=await fetch(t);return(await e.json()).city}catch(t){return console.log("Can not downoload data about your city!")}}(),a=await o(r),i=t(a);e(document.querySelector(".userCityBlock").getElementsByTagName("p").item(0),i),n(document.querySelector(".cityMap"),a)}()})();