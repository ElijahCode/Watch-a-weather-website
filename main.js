(()=>{"use strict";function t(t){return`\n    In ${t.name} now is \n    ${t.weather[0].main},\n    Temperature: ${t.main.temp} C,\n    Temperature is feels like: ${t.main.feels_like} C,\n    Humidity:${t.main.humidity}%,\n    Atmospheric pressure: ${t.main.pressure} Pa,\n    Wind speed: ${t.wind.speed} m/s`}function e(t,e){t.innerText=e}function n(t,e){const n=e.coord.lat,o=`https://static-maps.yandex.ru/1.x/?ll=${e.coord.lon},${n}&size=400,400&z=12&l=map&pt=37.620070,55.753630,pmwtm1~37.64,55.76363,pmwtm99`;t.src=o}async function o(t){try{const e=`https://api.openweathermap.org/data/2.5/weather?q=${t}&appid=29322a2e1ecf125b380cfcee03239f35&units=metric`,n=await fetch(e);return await n.json()}catch(t){return console.log("Can not downoload weather data!")}}function r(t,e,n,...o){0===o.length?t.addEventListener(e,n,!0):t.addEventListener(e,n.bind(null,...o))}0===localStorage.length&&localStorage.setItem("historyList",JSON.stringify([]));const i=document.querySelector(".textbox"),a=document.querySelector(".weatherInReqCity"),c=document.querySelector(".historyList"),s=document.querySelector(".cityMap");r(document.querySelector("button"),"click",(async function(r,i,a,c){const s=r.value;if(""===s)return console.log("Empty city requare!");const l=await o(s);return e(i,t(l)),function(t,e){const n=e.getElementsByTagName("li");if(Array.from(n).filter((e=>e.innerText===t)).length>0)return null;n.length>9&&(e.removeChild(n.item(0)),function(){const t=JSON.parse(localStorage.getItem("historyList"));t.shift(),localStorage.setItem("historyList",JSON.stringify(t))}());const o=document.createElement("li");o.innerText=t,e.append(o),function(t){const e=JSON.parse(localStorage.getItem("historyList"));e.push(t),localStorage.setItem("historyList",JSON.stringify(e))}(t)}(s,a),n(c,l),null}),i,a,c,s);const l=0===localStorage.length?null:JSON.parse(localStorage.getItem("historyList"));0!==l.lenght&&l.forEach((t=>{const e=document.createElement("li");e.innerText=t,c.append(e)})),r(document.querySelector(".historyList"),"click",(async function(r){const i=r.target.innerText,a=await o(i),c=t(a),s=document.querySelector(".weatherInReqCity"),l=document.querySelector(".cityMap");e(s,c),n(l,a)})),async function(){const r=await async function(){try{const t="https://get.geojs.io/v1/ip/geo.json",e=await fetch(t);return(await e.json()).city}catch(t){return console.log("Can not downoload data about your city!")}}(),i=await o(r),a=t(i);e(document.querySelector(".userCityBlock").getElementsByTagName("p").item(0),a),n(document.querySelector(".cityMap"),i)}()})();