(()=>{"use strict";var t={641:(t,e,s)=>{e.y=void 0;const i=s(830);e.y=class{constructor(t,e){this.cityListDefaultValue={cities:[{city:""}]},this.eventsDefualtValue={defaultEvent:()=>null},this.template="{{for data as cities}}\n<li> {{city}}</li>",this.el=t,e?(this.state=e,this.setState(this.state)):(this.state=this.cityListDefaultValue,this.setState(this.state)),this.events=this.eventsDefualtValue,this.onMountFlag=!1,this.onMount(t)}setState(t){this.state=t,this.render()}subscribeToEvents(){Object.keys(this.events).forEach((t=>{const[e,s]=t.split("@");document.querySelector(`.${s}`).addEventListener(e,this.events[t],!0)}))}onMount(t){this.onMountFlag=!0}render(){const t=i.template(this.template,this.state);return this.el.innerHTML=t,t}}},299:(t,e,s)=>{e.G=void 0;const i=s(830);e.G=class{constructor(t,e){this.weatherInCityCompTPL="In {{name}} now is\n{{weather}},\nTemperature: {{temp}} C,\nTemperature is feels like: {{tempFeelsLike}} C,\nHumidity:{{humidity}}%,\nAtmospheric pressure: {{pressure}} Pa,\nWind speed: {{windSpeed}} m/s",this.defaultWeather={weather:"",base:"",temp:0,tempFeelsLike:0,pressure:0,humidity:0,visibility:0,windSpeed:0,name:""},this.defaultEvents={defaultEvent:()=>null},this.el=t,this.state=this.defaultWeather,e?this.setState(e):this.setState(this.defaultWeather),this.events=this.defaultEvents,this.onMountFlag=!1,this.onMount(t)}subscribeToEvents(){Object.keys(this.events).forEach((t=>{const[e,s]=t.split("@");document.querySelector(`.${s}`).addEventListener(e,this.events[t])}))}setState(t){Object.keys(t).forEach((e=>{this.state[e]=t[e]})),this.render()}onMount(t){this.onMountFlag=!0}render(){const t=i.template(this.weatherInCityCompTPL,this.state);return this.el.innerHTML=t,t}}},980:(t,e)=>{e.k=void 0,e.k=function(t){return{name:t.name,weather:t.weather[0].main,temp:t.main.temp,tempFeelsLike:t.main.feels_like,humidity:t.main.humidity,pressure:t.main.pressure,windSpeed:t.wind.speed}}},830:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.template=void 0,e.template=function t(e,s){return e.replace(/{{if (\w+)}}\n?([a-zA-Z0-9{}<>"#!.,/= ]{1,})\n?{{endif}}/gm,((t,e,i)=>s[e]?i:"")).replace(/{{for \w+ as (\w+)}}\n?([a-zA-Z0-9{}()<>"#!.,/= ]{1,})\n?(_{{isFirst ([a-zA-Z0-9{}()<>"#!.,/= ]{1,})}})?\n?(_{{isLast ([a-zA-Z0-9{}()<>"#!.,/= ]{1,})}})?/g,((e,i,n,...a)=>{let r,o,c="";return/isFirst/.test(a[0])?(r=a[1],o=a[3]):(/isLast/.test(a[0])||a[3])&&(o=a[3]),s[i].forEach(((a,l)=>{let u;u=0===l&&void 0!==r?/{{index}}/g.test(r)?r.replace(/{{index}}/g,`${1+l}`):r:l===s[i].length-1&&void 0!==o?/{{index}}/g.test(o)?o.replace(/{{index}}/g,`${1+l}`):o:/{{index}}/g.test(n)?n.replace(/{{index}}/g,`${1+l}`):n,c+=/\n/g.test(e)?`${t(u,a)}\n`:t(u,a)})),c})).replace(/{{(\w+)}}/g,((t,e)=>s[e]?s[e]:""))}}},e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={exports:{}};return t[i](n,n.exports,s),n.exports}(()=>{function t(t,e){const s=e.coord.lat,i=`https://static-maps.yandex.ru/1.x/?ll=${e.coord.lon},${s}&size=400,400&z=12&l=map&pt=37.620070,55.753630,pmwtm1~37.64,55.76363,pmwtm99`;t.src=i}async function e(t){try{const e=`https://api.openweathermap.org/data/2.5/weather?q=${t}&appid=29322a2e1ecf125b380cfcee03239f35&units=metric`,s=await fetch(e);return await s.json()}catch(t){return console.log("Can not downoload weather data!")}}async function i(s){const i=s.target.innerText,n=await e(i),a=`\n    In ${(r=n).name} now is \n    ${r.weather[0].main},\n    Temperature: ${r.main.temp} C,\n    Temperature is feels like: ${r.main.feels_like} C,\n    Humidity:${r.main.humidity}%,\n    Atmospheric pressure: ${r.main.pressure} Pa,\n    Wind speed: ${r.wind.speed} m/s`;var r;const o=document.querySelector(".weatherInReqCity"),c=document.querySelector(".cityMap");!function(t,e){t.innerText=e}(o,a),t(c,n)}var n=s(980);function a(t){const e=JSON.parse(localStorage.getItem("historyList"));e.cities.push({city:t}),localStorage.setItem("historyList",JSON.stringify(e))}function r(t,e,s,...i){0===i.length?t.addEventListener(e,s,!0):t.addEventListener(e,s.bind(null,...i))}var o=s(299),c=s(641);0===localStorage.length&&localStorage.setItem("historyList",JSON.stringify({cities:[{city:""}]}));const l=new o.G(document.querySelector(".userCityBlock").getElementsByTagName("p").item(1)),u=new o.G(document.querySelector(".weatherInReqCity")),h=new c.y(document.querySelector(".historyList")),d=document.querySelector(".textbox"),m=document.querySelector(".cityMap");r(document.querySelector("button"),"click",(async function(s,i,r,o){const c=s.value;if(""===c)return console.log("Empty city requare!");const l=await e(c),u=(0,n.k)(l);return i.setState(u),function(t,e){for(let s=0;s<t.state.cities.length;s+=1)if(t.state.cities[s].city===e)return console.log("exit"),null;if(""===t.state.cities[0].city){const s=t.state;s.cities[0].city=e,t.setState(s),localStorage.clear(),localStorage.setItem("historyList",JSON.stringify({cities:[{city:e}]}))}else if(t.state.cities.length<10){const s=t.state;s.cities.push({city:e}),t.setState(s),a(e)}else{const s=t.state;s.cities.shift(),s.cities.push({city:e}),t.setState(s),function(){const t=JSON.parse(localStorage.getItem("historyList"));t.cities.shift(),localStorage.setItem("historyList",JSON.stringify(t))}(),a(e)}}(r,c),t(o,l),null}),d,u,h,m);const y=0===localStorage.length?null:JSON.parse(localStorage.getItem("historyList"));""!==y.cities[0].city&&h.setState(y),h.events={"click@historyList":i},h.subscribeToEvents(),r(document.querySelector(".historyList"),"click",i),async function(){const s=await async function(){try{const t="https://get.geojs.io/v1/ip/geo.json",e=await fetch(t);return(await e.json()).city}catch(t){return console.log("Can not downoload data about your city!")}}(),i=await e(s),a=(0,n.k)(i);l.setState(a),t(document.querySelector(".cityMap"),i)}()})()})();