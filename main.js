(()=>{"use strict";var t={502:(t,e,n)=>{e.y=void 0;var i=n(344),s=function(){function t(t,e){this.state={cities:[{city:""}]},this.events={defaultEvent:function(){return null}},this.el=t,e?this.setState(e):this.onMount(t)}return t.prototype.setState=function(t){this.state=t,this.render()},t.prototype.subscribeToEvents=function(){var t=this;Object.keys(this.events).forEach((function(e){var n=e.split("@"),i=n[0],s=n[1];document.querySelector("."+s).addEventListener(i,t.events[e],!0)}))},t.prototype.onMount=function(t){this.el.innerHTML=this.el.innerHTML},t.prototype.render=function(){var t=i.template("{{for data as cities}}\n<li> {{city}}</li>\n",this.state);return this.el.innerHTML=t,t},t}();e.y=s},36:(t,e,n)=>{e.G=void 0;var i=n(344),s={weather:"",base:"",temp:0,tempFeelsLike:0,pressure:0,humidity:0,visibility:0,windSpeed:0,name:""},r=function(){function t(t,e){this.state=s,this.events={defaultEvent:function(){return null}},this.el=t,e?this.setState(e):this.onMount(t)}return t.prototype.subscribeToEvents=function(){var t=this;Object.keys(this.events).forEach((function(e){var n=e.split("@"),i=n[0],s=n[1];document.querySelector("."+s).addEventListener(i,t.events[e])}))},t.prototype.setState=function(t){var e=this;Object.keys(t).forEach((function(n){e.state[n]=t[n]})),this.render()},t.prototype.onMount=function(t){this.render()},t.prototype.render=function(){var t=i.template("In {{name}} now is\n{{weather}},\nTemperature: {{temp}} C,\nTemperature is feels like: {{tempFeelsLike}} C,\nHumidity:{{humidity}}%,\nAtmospheric pressure: {{pressure}} Pa,\nWind speed: {{windSpeed}} m/s",this.state);return this.el.innerHTML=t,t},t}();e.G=r},747:(t,e)=>{e.k=void 0,e.k=function(t){return{name:t.name,weather:t.weather[0].main,temp:t.main.temp,tempFeelsLike:t.main.feels_like,humidity:t.main.humidity,pressure:t.main.pressure,windSpeed:t.wind.speed}}},344:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.template=void 0,e.template=function t(e,n){return e.replace(/{{if (\w+)}}\n?([a-zA-Z0-9{}<>"#!.,/= ]{1,})\n?{{endif}}/gm,(function(t,e,i){return n[e]?i:""})).replace(/{{for \w+ as (\w+)}}\n?([a-zA-Z0-9{}()<>"#!.,/= ]{1,})\n?(_{{isFirst ([a-zA-Z0-9{}()<>"#!.,/= ]{1,})}})?\n?(_{{isLast ([a-zA-Z0-9{}()<>"#!.,/= ]{1,})}})?/g,(function(e,i,s){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var a,c,u="";return/isFirst/.test(r[0])?(a=r[1],c=r[3]):(/isLast/.test(r[0])||r[3])&&(c=r[3]),n[i].forEach((function(r,o){var l;l=0===o&&void 0!==a?/{{index}}/g.test(a)?a.replace(/{{index}}/g,""+(1+o)):a:o===n[i].length-1&&void 0!==c?/{{index}}/g.test(c)?c.replace(/{{index}}/g,""+(1+o)):c:/{{index}}/g.test(s)?s.replace(/{{index}}/g,""+(1+o)):s,u+=/\n/g.test(e)?t(l,r)+"\n":t(l,r)})),u})).replace(/{{(\w+)}}/g,(function(t,e){return n[e]?n[e]:""}))}}},e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}(()=>{function t(t,e){const n=e.coord.lat,i=`https://static-maps.yandex.ru/1.x/?ll=${e.coord.lon},${n}&size=400,400&z=12&l=map&pt=37.620070,55.753630,pmwtm1~37.64,55.76363,pmwtm99`;t.src=i}async function e(t){try{const e=`https://api.openweathermap.org/data/2.5/weather?q=${t}&appid=29322a2e1ecf125b380cfcee03239f35&units=metric`,n=await fetch(e);return await n.json()}catch(t){return console.log("Can not downoload weather data!")}}async function i(n){const i=n.target.innerText,s=await e(i),r=`\n    In ${(o=s).name} now is \n    ${o.weather[0].main},\n    Temperature: ${o.main.temp} C,\n    Temperature is feels like: ${o.main.feels_like} C,\n    Humidity:${o.main.humidity}%,\n    Atmospheric pressure: ${o.main.pressure} Pa,\n    Wind speed: ${o.wind.speed} m/s`;var o;const a=document.querySelector(".weatherInReqCity"),c=document.querySelector(".cityMap");!function(t,e){t.innerText=e}(a,r),t(c,s)}var s=n(747);function r(t){const e=JSON.parse(localStorage.getItem("historyList"));e.cities.push({city:t}),localStorage.setItem("historyList",JSON.stringify(e))}function o(t,e,n,...i){0===i.length?t.addEventListener(e,n,!0):t.addEventListener(e,n.bind(null,...i))}var a=n(36),c=n(502);0===localStorage.length&&localStorage.setItem("historyList",JSON.stringify({cities:[{city:""}]}));const u=new a.G(document.querySelector(".userCityBlock").getElementsByTagName("p").item(1)),l=new a.G(document.querySelector(".weatherInReqCity")),p=new c.y(document.querySelector(".historyList")),y=document.querySelector(".textbox"),d=document.querySelector(".cityMap");o(document.querySelector("button"),"click",(async function(n,i,o,a){const c=n.value;if(""===c)return console.log("Empty city requare!");const u=await e(c),l=(0,s.k)(u);return i.setState(l),function(t,e){for(let n=0;n<t.state.cities.length;n+=1)if(t.state.cities[n].city===e)return console.log("exit"),null;if(""===t.state.cities[0].city){const n=t.state;n.cities[0].city=e,t.setState(n),localStorage.clear(),localStorage.setItem("historyList",JSON.stringify({cities:[{city:e}]}))}else if(t.state.cities.length<10){const n=t.state;n.cities.push({city:e}),t.setState(n),r(e)}else{const n=t.state;n.cities.shift(),n.cities.push({city:e}),t.setState(n),function(){const t=JSON.parse(localStorage.getItem("historyList"));t.cities.shift(),localStorage.setItem("historyList",JSON.stringify(t))}(),r(e)}}(o,c),t(a,u),null}),y,l,p,d);const h=0===localStorage.length?null:JSON.parse(localStorage.getItem("historyList"));""!==h.cities[0].city&&p.setState(h),p.events={"click@historyList":i},p.subscribeToEvents(),o(document.querySelector(".historyList"),"click",i),async function(){const n=await async function(){try{const t="https://get.geojs.io/v1/ip/geo.json",e=await fetch(t);return(await e.json()).city}catch(t){return console.log("Can not downoload data about your city!")}}(),i=await e(n),r=(0,s.k)(i);u.setState(r),t(document.querySelector(".cityMap"),i)}()})()})();